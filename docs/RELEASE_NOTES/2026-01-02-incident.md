# Release Notes — Incident: 2026-01-02

## Summary
- **Incident:** Production timeouts reported by users and UI showing "Request timed out. Please check your connection.".
- **Date:** 2026-01-02
- **Impact:** Production API returned errors / site unavailable after a failed deploy.

## Root Cause
- Build failed during deploy due to a backend/frontend mismatch:
  - Backend code was referencing an outdated property name (`credits_remaining`), while the database migrations and the current model use `remaining_credits` / `total_credits` (naming mismatch).
  - There was also a prior frontend parse error in an older commit which contributed to the failing deploy.

## Fix
- Created branch `fix/remaining-credits-field` and pushed fixes (commit ea31c2b):
  - Normalized user credit fields to `total_credits` / `remaining_credits` / `purchase_date`.
  - Updated backend models, controllers, service logic, and init SQL.
  - Verified `npm run build` for backend and `npm run build` for the frontend locally; tests passed (DB tests skipped by default).
  - Updated `render.yaml` to require `SQUARE_WEBHOOK_SECRET` and `SQUARE_WEBHOOK_SIGNATURE_KEY` env vars so webhook signature verification can be enabled in production.

## Branch/Commits
- Branch: `fix/remaining-credits-field`
- Latest commit: ea31c2b
- PR: open a PR against `main` from the branch above and ensure CI runs.

## Checklist (to complete deployment)
- [ ] Add/set env vars in Render: `DATABASE_URL`, `SQUARE_ACCESS_TOKEN`, `SQUARE_LOCATION_ID`, `SQUARE_WEBHOOK_SECRET`, `SQUARE_WEBHOOK_SIGNATURE_KEY`.
- [ ] Open PR and run CI; fix any CI failures.
- [ ] Merge and deploy to production.
- [ ] Smoke test `/health` and a representative API flow (auth, credits, bookings).
- [ ] Monitor logs and metrics for 15–30 minutes post-deploy.

## Notes
- If immediate restoration is required, perform a rollback to the last successful Render deploy then merge the fix branch and deploy the corrected release.
- Keep this file updated with PR number and deploy timestamps after the release.
